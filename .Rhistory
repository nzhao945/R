class(train[,c("PassengerId","Cabin"))
class(train[,c("PassengerId","Cabin")])
nrow(train[Cabin==" "])
nrow(train[Cabin==""])
nrow(train[Cabin %in% " "])
nrow(train[Cabin %in% ""])
train[Cabin==""] <- NA
View(train)
train <- fread(header = T,stringsAsFactors = F,
file = "G:/R/kaggle_data/Titanic Machine Learning from Disaster/train.csv")
train$Cabin[Cabin==""] <- NA
train[Cabin=="",list(Cabin)] <- NA
train[,list(Cabin)]
train[Cabin=="",list(Cabin)]
train[Cabin=="",list(Cabin)] <- NA
train[train$Cabin=="",Cabin]
train[train$Cabin=="",Cabin] <- NA
train[train$Cabin=="",train$Cabin] <- NA
train[train$Cabin=="",train$Cabin]
train[,Cabin==""]
train[,train$Cabin==""]
View(train)
View(tuk)
nrow(train[Cabin==""])
train$Cabin[train$Cabin==""] <- NA
View(train)
md.pattern(train)
is.null(train$Cabin)
is.na(train$Cabin)
md.pattern(train)
is.na(train$Name)
train <- fread(header = T,stringsAsFactors = F,
file = "G:/R/kaggle_data/Titanic Machine Learning from Disaster/train.csv")
test <- fread(header = T,stringsAsFactors = F,
file = "G:/R/kaggle_data/Titanic Machine Learning from Disaster/test.csv")
test$Survived <- NA
comb <- rbind(train,test)
sum(is.na(train$Cabin))
sum(is.na(train$Name))
sum(is.na(train$Age))
train$Cabin[train$Cabin==""] <- NA
sum(is.na(train$Cabin))
687/891
sum(is.na(train$Fare))
sum(is.na(train$Embarked))
library(dplyr)
rm(comb)
# 合并train和test
comb <- rbind(train,test)
View(comb)
summary(train)
glimpse(train)
str(train)
train <- train %>% mutate(Survived = factor(Survived),Pclass = factor(Pclass),
Embarked = factor(Embarked),Sex = factor(Sex))
test <- test %>% mutate(Pclass = factor(Pclass),Embarked = factor(Embarked),Sex = factor(Sex))
# 合并train和test,test中不存在的列Survived会自动生成NA
comb <- rbind(train,test)
aggr(comb, prop = FALSE, combined = TRUE, numbers = TRUE, sortVars = TRUE, sortCombs = TRUE)
md.pattern(test)
md.pattern(train)
md.pattern(test)
md.pattern(comb)
view
View(nhanes)
ggplot(train, aes(Pclass, Fare, colour = Survived)) +
geom_boxplot() +
ggplot(train, aes(Pclass, Fare, colour = Survived)) +
geom_boxplot()
library(ggplot2)
ggplot(train, aes(Pclass, Fare, colour = Survived)) +
geom_boxplot()
ggplot(train, aes(Pclass, log10(Fare), colour = Survived)) +
geom_boxplot()
ggplot(train, aes(Pclass, Fare, colour = Survived)) +
geom_boxplot() + scale_y_log10()
library(data.table)
str(comb)
setDT(comb)
str(comb)
comb[is.na(Embarked)]
comb[is.na(Embarked),]
comb[is.na(Embarked)][]
comb[is.na(Embarked)][[]]
comb[is.na(Embarked)][][]
comb[,comb$Embarked==NA]
comb[,is.na(comb$Embarked)]
comb[is.na(comb$Embarked),]
is.na(comb$Embarked)
library(dplyr)
filter(comb,is.na(Embarked))
View(comb)
train <- fread(header = T,stringsAsFactors = F,na.strings = "NA"
file = "G:/R/kaggle_data/Titanic Machine Learning from Disaster/train.csv")
#导入训练集和测试集
train <- fread(header = T,stringsAsFactors = F,na.strings = "NA",
file = "G:/R/kaggle_data/Titanic Machine Learning from Disaster/train.csv")
View(train)
View(train)
train$Embarked <- factor(train$Embarked)
View(train)
sum(is.na(train$Embarked))
sum(train[Embarked==""])
sum(train[Embarked=="",])
train[Age==NA]
train[Age==NA,]
train[Age=NA]
train[Age=19]
train[Age==19]
train[Age=="NA"]
train[Age==NA]
train[is.na(Age)]
train[Embarked==""]
train[""]
train[1==""]
train$Embarked[Embarked==""]
train$Embarked[""]
train$Embarked[train$Embarked=""]
train$Embarked[train$Embarked="",]
train$Embarked[train$Embarked=="",]
train$Embarked[train$Embarked==""]
train$Embarked[train$Embarked=="C"]
train$Embarked[train$Embarked==""] <- NA
sum(is.na(train$Embarked))
tmp <- read_csv('G:/R/kaggle_data/Titanic Machine Learning from Disaster/test.csv')
tmp <- read.csv('G:/R/kaggle_data/Titanic Machine Learning from Disaster/test.csv')
View(tmp)
sum(is.na(tmp$Embarked))
tmp <- read.csv('G:/R/kaggle_data/Titanic Machine Learning from Disaster/train.csv')
sum(is.na(tmp$Embarked))
rm(tmp)
#导入训练集和测试集
train <- fread(header = T,
file = "G:/R/kaggle_data/Titanic Machine Learning from Disaster/train.csv")
View(train)
library(mice)
library(ggplot2)
train <- fread(header = T,stringsAsFactors = F,
file = "G:/R/kaggle_data/Titanic Machine Learning from Disaster/train.csv")
View(train)
train$Cabin[train$Cabin==""] <- NA
View(train)
# 发现部分缺失值并没有被读取为NA，而是""，所以作如下操作
train$Embarked[train$Embarked==""] <- NA
sum(is.na(train$Embarked))
md.pattern(train)
library(VIM)
aggr(train)
aggr(train,numbers=T)
aggr(train, prop = F)
aggr(train, prop = F, combined = T)
aggr(train, prop = F, axes=T
)
aggr(train, prop = F, number = T)
# 合并train和test,test中不存在的列Survived会自动生成NA
comb <- rbind(train,test)
aggr(comb, prop = FALSE, combined = TRUE, numbers = TRUE, sortVars = TRUE, sortCombs = TRUE)
train <- fread(header = T,stringsAsFactors = F,
file = "G:/R/kaggle_data/Titanic Machine Learning from Disaster/train.csv")
test <- fread(header = T,stringsAsFactors = F,
file = "G:/R/kaggle_data/Titanic Machine Learning from Disaster/test.csv")
# 合并train和test,test中不存在的列Survived会自动生成NA
comb <- rbind(train,test)
aggr(comb, prop = FALSE, combined = TRUE, numbers = TRUE, sortVars = TRUE, sortCombs = TRUE)
View(comb)
View(test)
# 合并train和test,test中不存在的列Survived会自动生成NA
comb <- rbind(train,test)
View(comb)
rm(comb)
# 合并train和test,test中不存在的列Survived会自动生成NA
comb <- rbind(train,test)
# 合并train和test,test中不存在的列Survived会自动生成NA
comb <- rbind(train,test)
?rbind
# 合并train和test,test中不存在的列Survived会自动生成NA
comb <- rbind(train,test,fill=NA)
# 合并train和test,test中不存在的列Survived会自动生成NA
comb <- rbind(train,test,fill=T)
view(comb)
view(comb)
View(comb)
aggr(combine, prop = FALSE, combined = TRUE, numbers = TRUE, sortVars = TRUE, sortCombs = TRUE)
aggr(comb, prop = FALSE, combined = TRUE, numbers = TRUE, sortVars = TRUE, sortCombs = TRUE)
?rbind
comb$Embarked[comb$Embarked==""] <- NA
comb$Cabin[comb$Cabin==""] <- NA
sum(nrow(comb$Pclass[comb$Pclass==""]))
sum(nrow(comb$Sex[comb$Sex==""]))
sum(nrow(comb$Fare[comb$Fare==""]))
sum(nrow(comb$Ticket[comb$Ticket==""]))
sum(nrow(comb$Embarked[comb$Ticket==""]))
sum(nrow(comb$Embarked[comb$Embarked==""]))
#缺失值可视化
aggr(comb, prop = FALSE, combined = TRUE, numbers = TRUE, sortVars = TRUE, sortCombs = TRUE)
md.pattern(trian)
md.pattern(train)
comb %>%
filter(Embarked != "Q" & Pclass == 1 & Sex == "female") %>%
group_by(Embarked, Pclass, Sex, Pclass, Parch, SibSp) %>%
summarise(count = n())
md.pattern(comb)
train[is.na(Embarked)]
train[Embarked==NA]
train[Embarked=NA]
train[train$Embarked==NA,]
train[train$Embarked=NA,]
train[is.na(train$Embarked),]
filter(train,is.na(Embarked))
sum(is.na(trian$emba))
sum(is.na(train$Embarked))
train$Embarked[train$Embarked==""] <- NA
train$Cabin[train$Cabin==""] <- NA
# 合并train和test,test中不存在的列Survived由参数fill=T生成NA
comb <- rbind(train,test, fill = T)
sum(is.na(train$Embarked))
train %>% filter(is.na(Embarked))
#缺失值可视化
aggr(train, prop = FALSE, combined = TRUE, numbers = TRUE, sortVars = TRUE, sortCombs = TRUE)
sum(is.na(train$Cabin))
md.pattern(train)
View(train)
sum(is.na(train$Embarked))
train %>% filter(is.na(Embarked))
View(comb)
#增加Title列
comb$Title <- gsub('(.*, )|(\\..*)', '', comb$Name)
table(comb$Sex,comb$Title)
library(data.table)
temp <- fread(file = "G:/R/kaggle_data/Titanic Machine Learning from Disaster/train.csv", header = T,
stringsAsFactors = F, na.strings = c("NA",""))
View(temp)
temp <- fread(file = "G:/R/kaggle_data/Titanic Machine Learning from Disaster/train.csv", header = T,
stringsAsFactors = F, na.strings = c("NA","","N/A","null"))
View(temp)
sum(is.na(temp$Embarked))
which(table(comb$Sex,comb$Title)>200)
#导入训练集和测试集,发现部分空值不能正确读取为NA，故加入参数na.strings = c("NA","")
train <- fread(header = T, stringsAsFactors = F,na.strings = c("NA","","N/A","null"),
file = "G:/R/kaggle_data/Titanic Machine Learning from Disaster/train.csv")
library(VIM)
#缺失值可视化
aggr(train, prop = FALSE, combined = TRUE, numbers = TRUE, sortVars = TRUE, sortCombs = TRUE)
nrow(na.omit(train))
table(comb$Sex,comb$Title)
View(test)
View(mygraph)
gc()
table(comb$Sex,comb$Title)
itle <- c("Capt","Col","Don","Dona","Dr","Jonkheer","Lady","Major","Rev","Sir","the Countess")
comb$Title[comb$Title == 'Mlle'] <- 'Miss'
comb$Title[comb$Title == 'Ms'] <- 'Miss'
comb$Title[comb$Title == 'Mme'] <- 'Mrs'
comb$Title[comb$Title %in% rare_title] <- 'Rare Title'
rare_title <- c("Capt","Col","Don","Dona","Dr","Jonkheer","Lady","Major","Rev","Sir","the Countess")
comb$Title[comb$Title %in% rare_title] <- 'Rare Title'
table(comb$Sex,comb$Title)
library(ggplot2)
ggplot(comb,aes(Title))
geom_bar(aes(fill=Survived))
ggplot(comb,aes(Title,fill=Survived))
geom_bar(stat = "count",position = "dodge")
ggplot(comb,aes(Title,fill=Survived))+
geom_bar(stat = "count",position = "dodge")
str(train)
train <- train %>% mutate(Survived = factor(Survived),Pclass = factor(Pclass),
Embarked = factor(Embarked),Sex = factor(Sex))
library(magrittr)
library(dplyr)
train <- train %>% mutate(Survived = factor(Survived),Pclass = factor(Pclass),
Embarked = factor(Embarked),Sex = factor(Sex))
test <- test %>% mutate(Pclass = factor(Pclass),Embarked = factor(Embarked),Sex = factor(Sex))
temp <- rbind(train,test,fill = T)
test <- test %>% mutate(Survived = "NA",Pclass = factor(Pclass),
Embarked = factor(Embarked),Sex = factor(Sex))
temp <- rbind(train,test,fill = T)
test <- test %>% mutate(Pclass = factor(Pclass),
Embarked = factor(Embarked),Sex = factor(Sex))
temp <- rbind(train,test, fill = T)
View(temp)
test <- test[,-c("Survived")]
test <- test[,-Survived]
test <- test[,-test$Survived]
test <- test[,!test$Survived]
test <- select(test,-Survived)
View(test)
temp <- rbind(train,test)
temp <- rbind(train,test,fill=NA)
temp <- rbind(train,test,fill=T)
temp <- bind_rows(test,train)
View(temp)
View(comb)
View(temp)
temp <- bind_rows(train,test)
View(temp)
temp$Title <- comb$Title
View(temp)
comb <- temp
rm
rm(temp)
gc()
###下面开始进行初步探索数据集###
table(comb$Sex,comb$Title)
ggplot(train,aes(Title,fill = Survived))
ggplot(comb[1:891],aes(Title,fill = Survived))
ggplot(comb[1:891,],aes(Title,fill = Survived))
geom_bar(stat = "count",position = "dodge")
geom_bar(stat = 'count',position = 'dodge')
ggplot(comb[1:891,],aes(Title,fill = Survived))
geom_bar(stat = "count",position = "dodge")
ggplot(comb[1:891,],aes(Title,fill = Survived))+
geom_bar(stat = "count",position = "dodge")
labs("no point")
+labs("no point")
ggplot(comb[1:891,],aes(Ticket,Fare,fill = Survived))+
geom_point()
ggplot(comb[1:891,],aes(Ticket,Fare))+
geom_point()
ggplot(comb[1:891,],aes(Ticket,Embarked))+
geom_point()
ggplot(comb[1:891,],aes(factor(Ticket),Fare))+
geom_point()
nlevels(factor(comb[1:891,]$Ticket))
load("G:/R/.RData")
rm(mymatrix)
rm(dim1)
##apply函数族
by1
##apply函数族
counts
rm(dim2,dim3,rnames,xx,yy,z,cnames,by1,by2,cells,counts)
View(relweights)
?base
??base
library(help='base')
is.R()
gc()
rm(list=ls())
# 封装fun1
fun1<-function(x){
myFUN<- function(x, c1, c2) {
c(sum(x[c1],1), mean(x[c2]))
}
apply(x,1,myFUN,c1='x1',c2=c('x1','x2'))
}
# 封装fun2
fun2<-function(x){
df<-data.frame()
for(i in 1:nrow(x)){
row<-x[i,]
df<-rbind(df,rbind(c(sum(row[1],1), mean(row))))
}
}
# 封装fun3
fun3<-function(x){
data.frame(x1=x[,1]+1,x2=rowMeans(x))
}
# 生成数据集
x <- cbind(x1=3, x2 = c(400:1, 2:500))
load("G:/R/.RData")
load("G:/R/.RData")
load("C:/Users/nzhao/Desktop/RData")
load("C:/Users/nzhao/Desktop/RData")
View(fun1)
rm(z,yy,xx,t,rnames,dim1:dim3,counts,cnames,cells,by1:2,dt)
rm(z,yy,xx,t,rnames,dim1:dim3,counts,cnames,cells,by1,by2,dt)
rm(z,yy,xx,t,rnames,dim1,dim2,dim3,counts,cnames,cells,by1,by2,dt)
train <- train %>% mutate(Survived = factor(Survived),Pclass = factor(Pclass),
Embarked = factor(Embarked),Sex = factor(Sex))
library(magrittr)
train <- train %>% mutate(Survived = factor(Survived),Pclass = factor(Pclass),
Embarked = factor(Embarked),Sex = factor(Sex))
library(dplyr)
train <- train %>% mutate(Survived = factor(Survived),Pclass = factor(Pclass),
Embarked = factor(Embarked),Sex = factor(Sex))
test <- test %>% mutate(Pclass = factor(Pclass),
Embarked = factor(Embarked),Sex = factor(Sex))
# 合并train和test,自动补全test中的Survived=NA
comb <- dplyr::bind_rows(train,test)
View(comb)
rare_title <- c("Capt","Col","Don","Dona","Dr","Jonkheer","Lady","Major","Rev","Sir","the Countess")
comb$Title[comb$Title == 'Mlle'] <- 'Miss'
comb$Title[comb$Title == 'Ms'] <- 'Miss'
comb$Title[comb$Title == 'Mme'] <- 'Mrs'
comb$Title[comb$Title %in% rare_title] <- 'Rare Title'
#增加Title列
comb$Title <- gsub('(.*, )|(\\..*)', '', comb$Name)
rare_title <- c("Capt","Col","Don","Dona","Dr","Jonkheer","Lady","Major","Rev","Sir","the Countess")
comb$Title[comb$Title == 'Mlle'] <- 'Miss'
comb$Title[comb$Title == 'Ms'] <- 'Miss'
comb$Title[comb$Title == 'Mme'] <- 'Mrs'
comb$Title[comb$Title %in% rare_title] <- 'Rare Title'
rm(mymatrix)
system.time(fun1(x))
system.time(fun2(x))
system.time(fun3(x))
str(cbind(x1=3, x2=c(2:1,4:5)))
cbind(x1=3, x2=c(2:1,4:5))
sapply(cbind(x1=3, x2=c(2:1,4:5)),sum)
str(1:2)
a <- 1:2
str(a)
rm
rm(a)
View(iris)
tapply(iris$Petal.Length,iris$Species,mean)
library(dplyr)
group_by(iris$Petal.Length,iris$Species)
iris$Petal.Length %>% group_by(,iris$Species) %>% mean()
iris$Petal.Length %>% group_by(,iris$Species,mean)
iris$Petal.Length %>% group_by(,iris$Species,mean())
iris$Petal.Length %>% group_by(iris$Species) %>% summarise(mean=mean())
iris %>% group_by(iris$Species) %>% summarise(mean=mean())
iris %>% group_by(.,iris$Species) %>% summarise(mean=mean())
iris %>% group_by(.,iris$Species) %>% summarise(.,mean=mean())
library(magrittr)
group_by(iris,Species)
iris %>% group_by(Species)
iris %>% group_by(Species) %>% summarise(mean = mean(Petal.Length))
2%%2
2%/%2
2\2
2%%4
2%%
3%/%2
3%\%2
env.profile()
View(train)
library(data.table)
library(ggplot2)
train <- fread(header = T, stringsAsFactors = F,na.strings = c("NA","","N/A","null"),
file = "G:/R/kaggle_data/Titanic Machine Learning from Disaster/train.csv")
test <- fread(header = T, stringsAsFactors = F,na.strings = c("NA","","N/A","null"),
file = "G:/R/kaggle_data/Titanic Machine Learning from Disaster/test.csv")
train <- train %>% mutate(Survived = factor(Survived),Pclass = factor(Pclass),
Embarked = factor(Embarked),Sex = factor(Sex))
test <- test %>% mutate(Pclass = factor(Pclass),
Embarked = factor(Embarked),Sex = factor(Sex))
# 合并train和test,自动补全test中的Survived=NA
comb <- dplyr::bind_rows(train,test)
#增加Title列
comb$Title <- gsub('(.*, )|(\\..*)', '', comb$Name)
rare_title <- c("Capt","Col","Don","Dona","Dr","Jonkheer","Lady","Major","Rev","Sir","the Countess")
comb$Title[comb$Title == 'Mlle'] <- 'Miss'
comb$Title[comb$Title == 'Ms'] <- 'Miss'
comb$Title[comb$Title == 'Mme'] <- 'Mrs'
comb$Title[comb$Title %in% rare_title] <- 'Rare Title'
library()
library(VIM)
#缺失值可视化
aggr(train, prop = FALSE, combined = TRUE, numbers = TRUE, sortVars = TRUE, sortCombs = TRUE)
View(train)
library(ggplot2)
ggplot(train,aes(Fare,color= Survived))+
geom_density()
ggplot(train,aes(Fare,color= Survived))+
geom_density(stat = 'count', show.legend = T)
ggplot(train,aes(Fare,color= Survived))+
geom_histogram(stat = 'count', show.legend = T)
ggplot(train,aes(Fare,color= Survived))+
geom_histogram(stat = 'count', show.legend = T, bins = 20)
ggplot(train,aes(Fare,color= Survived))+
geom_histogram(stat = 'count', show.legend = T, bins = 10)
train[train$Embarked==NA,]
train[train$Embarked=NA,]
train[is.na(train$Embarked),]
ggplot(train,aes(Embarked,fill = Survived))+
geom_bar(position = 'dodge', stat = 'count')
head(gsub('(.*, )|(\\..*)', '', comb$Name),20)
head(gsub('(.*, )|(\\..*)', '..', comb$Name),20)
head(gsub('(.*, )', '..', comb$Name),20)
head(gsub('(.*, )|(\...*)', '..', comb$Name),20)
head(gsub('(.*, )|(\..*)', '..', comb$Name),20)
head(gsub('(\\..*)', '..', comb$Name),20)
head(gsub('(\..*)', '..', comb$Name),20)
head(sub('(\..*)', '..', comb$Name),20)
head(gsub('(.*, )|(\..*)', '..', comb$Name),20)
strsplit(comb$Name,split = '[,.]')
strsplit(comb$Name,split = '[,.]')[[1]][1]
head(strsplit(comb$Name,split = '[,.]')[[1]][1])
head(strsplit(comb$Name,split = '[,.]'))
title <- head(sapply(comb$Name,function(x)strsplit(x,split = '[,.]')[[1]][2]))
title
class(title)
View(titl)
View(title)
ncol(title)
nrow(title)
dim(title)
head(strsplit(comb$Name, split = '[,.]')[[1]][1])
head(strsplit(comb$Name, split = '[,.]')[[1]][2])
head(sapply(comb$Name,function(x)strsplit(x,split = '[,.]')[[1]][2]))
Surname <- sapply(comb$Name,
function(x) strsplit(x, split = '[,.]')[[1]][1])
View(Surname)
title <- sapply(comb$Name,function(x)strsplit(x,split = '[,.]')[[1]][2])
View(title)
rm(title)
rm(Surname)
title <- sapply(comb$Name,function(x)strsplit(x,split = '[,.]')[[1]][2])
str(title)
str(comb$Title)
library(magrittr)
library(data.table)
temp <- copy(comb) %>% .$title <- title
temp <- copy(comb)
temp$title <- title
View(temp)
rm(title)
rm(temp)
library(ggplot2)
lapply(comb, function(x) length(unique(x)))
